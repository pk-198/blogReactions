<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.4">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Helvetica; min-height: 14.0px}
  </style>
</head>
<body>
<p class="p1">&lt;!DOCTYPE html&gt;</p>
<p class="p1">&lt;html lang="en"&gt;</p>
<p class="p1">&lt;head&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;meta charset="UTF-8"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;title&gt;Blog Reactions Dashboard&lt;/title&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"&gt;&lt;/script&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;style&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>body { font-family: sans-serif; padding: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>table { width: 100%; border-collapse: collapse; margin-top: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>th { cursor: pointer; background-color: #f5f5f5; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>tr:nth-child(even) { background-color: #fafafa; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.filter-section { margin-bottom: 20px; }</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>.filter-section label, .filter-section input {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>margin-right: 10px;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/style&gt;</p>
<p class="p1">&lt;/head&gt;</p>
<p class="p1">&lt;body&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;h1&gt;Blog Reaction Dashboard&lt;/h1&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;div class="filter-section"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;label for="startDate"&gt;Start Date:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;input type="date" id="startDate"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;label for="endDate"&gt;End Date:&lt;/label&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;input type="date" id="endDate"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;button onclick="loadReactions()"&gt;Filter&lt;/button&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;table id="reactionTable"&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;th onclick="sortTable(0)"&gt;Blog Title&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;th onclick="sortTable(1)"&gt;Total Votes&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;th onclick="sortTable(2)"&gt;ğŸ‘ Up Votes&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;th onclick="sortTable(3)"&gt;ğŸ‘ Down Votes&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;th onclick="sortTable(4)"&gt;â­ Overall Rating&lt;/th&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;/tr&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;/thead&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>&lt;tbody&gt;&lt;/tbody&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/table&gt;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;script&gt;</p>
<p class="p2"><span class="Apple-converted-space">Â Â  Â </span></p>
<p class="p1"><span class="Apple-converted-space">Â  </span>const firebaseConfig = {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>apiKey: "AIzaSyAH3dii31iHaddF84QU4WcpJi5Q19x3Z1w",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>authDomain: "dograh-ghost-blog-reactions.firebaseapp.com",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>projectId: "dograh-ghost-blog-reactions",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>storageBucket: "dograh-ghost-blog-reactions.firebasestorage.app",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>messagingSenderId: "736797014557",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>appId: "1:736797014557:web:8a57061b95900bfba064f4",</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>measurementId: "G-0J0NXYH7JS"</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>};</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>firebase.initializeApp(firebaseConfig);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const db = firebase.firestore();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>const tableBody = document.querySelector('#reactionTable tbody');</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function getDateInput(id) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const value = document.getElementById(id).value;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>return value ? new Date(value) : null;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>async function loadReactions() {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>tableBody.innerHTML = "Loading...";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const startDate = getDateInput("startDate");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const endDate = getDateInput("endDate");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const dataMap = {};</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const snapshot = await db.collection("reactions").get();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>snapshot.forEach(doc =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const data = doc.data();</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const { postId, reactionType, timestamp } = data;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!postId || !reactionType) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const reactionTime = timestamp?.toDate?.() || new Date();</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>(startDate &amp;&amp; reactionTime &lt; startDate) ||</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>(endDate &amp;&amp; reactionTime &gt; endDate)</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>) return;</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!dataMap[postId]) dataMap[postId] = { up: 0, down: 0 };</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>dataMap[postId][reactionType]++;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>});</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>populateTable(dataMap);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function populateTable(dataMap) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>tableBody.innerHTML = "";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>Object.entries(dataMap).forEach(([postId, { up, down }]) =&gt; {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const total = up + down;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const rating = total &gt; 0 ? (up / total).toFixed(2) : "0.00";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const row = document.createElement('tr');</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>row.innerHTML = `</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;td&gt;${postId}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;td&gt;${total}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;td&gt;${up}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;td&gt;${down}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>&lt;td&gt;${rating}&lt;/td&gt;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>`;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>tableBody.appendChild(row);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>});</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>function sortTable(n) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>const table = document.getElementById("reactionTable");</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>let switching = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>let dir = "desc";</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>while (switching) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>switching = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>let rows = table.rows;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>for (let i = 1; i &lt; rows.length - 1; i++) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let shouldSwitch = false;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let x = rows[i].getElementsByTagName("TD")[n];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>let y = rows[i + 1].getElementsByTagName("TD")[n];</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const xVal = isNaN(x.innerHTML) ? x.innerHTML.toLowerCase() : parseFloat(x.innerHTML);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>const yVal = isNaN(y.innerHTML) ? y.innerHTML.toLowerCase() : parseFloat(y.innerHTML);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>if ((dir === "asc" &amp;&amp; xVal &gt; yVal) || (dir === "desc" &amp;&amp; xVal &lt; yVal)) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>shouldSwitch = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>break;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (shouldSwitch) {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>switching = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>} else if (!switching &amp;&amp; dir === "desc") {</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>dir = "asc";</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  </span>switching = true;</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  Â  </span>}</p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>}</p>
<p class="p2"><br></p>
<p class="p1"><span class="Apple-converted-space">Â  Â  </span>loadReactions();</p>
<p class="p1"><span class="Apple-converted-space">Â  </span>&lt;/script&gt;</p>
<p class="p1">&lt;/body&gt;</p>
<p class="p1">&lt;/html&gt;</p>
</body>
</html>
